- defaults:
    link:
      create: true
    shell:
      stdin: true
      stdout: true
      stderr: true

- clean:
    ~/.config:
        recursive: true
    # Dotbot fails if I don't add a slash after '~'
    ~/: {}
    ~/.vim: {}
    ~/.local/bin: {}

- link:
    ~/.tmux.conf: tmux/tmux.conf
    ~/.vim/vimrc: vim/vimrc
    ~/.config/nvim/init.vim: neovim/init.vim
    ~/.config/nvim/external-plugins.vim: neovim/external-plugins.vim
    ~/.config/nvim/plugin/:
        glob: true
        path: neovim/plugin/*
    ~/.local/share/nvim/external-plugin-snapshot.vim: neovim/external-plugin-snapshot.vim
    ~/.gitconfig: git/gitconfig
    ~/.bashrc: bash/bashrc
    ~/.profile: bash/profile
    ~/.config/kitty: kitty
    ~/.config/kitty/current-theme.conf:
        path: ~/.config/kitty/night-theme.conf
        if: '[ ! -f ~/.config/kitty/current-theme.conf ]'
    ~/.asdfrc: asdf/asdfrc
    ~/.tool-versions: asdf/tool-versions
    ~/.local/bin/:
        glob: true
        path: executables/*
    ~/.cloudflared/config.yaml: cloudflared/config.yaml
    ~/.ripgreprc: ripgrep/ripgreprc
    ~/.config/gitui/theme.ron: gitui/theme.ron
    ~/.inputrc: readline/inputrc
    # The reason I symlink the entire fish folder instead of linking
    # the individual files is that watchman does not support change detection in symlinks.
    # By symlinking the entire folder, the files themselves will not be symlinks.
    # watchman issue: https://github.com/facebook/watchman/issues/105
    ~/.config/fish/my-fish: fish
    ~/.config/fish/config.fish: ~/.config/fish/my-fish/config.fish
    ~/.config/fish/functions/:
        glob: true
        path: ~/.config/fish/my-fish/functions/*
    ~/.config/fish/conf.d/:
        glob: true
        path: ~/.config/fish/my-fish/conf.d/*
    ~/.config/fish/fish_plugins: fish/fish_plugins
    ~/.config/bat/config: bat/config
    ~/.lesskey: less/lesskey
    ~/.config/bat/themes/base16-brighter.tmTheme: bat/base16-brighter.tmTheme
    ~/.config/direnv/direnv.toml: direnv/direnv.toml
    ~/.ignore: ignore
    ~/.default-cargo-crates: asdf/default-cargo-crates
    ~/.config/pipr/pipr.toml: pipr/pipr.toml
    ~/.config/brewfile/Brewfile: brew/Brewfile
    ~/.config/pipx/pipx-packages.json: pipx/pipx-packages.json
    ~/.local/bin/reload-kitty: kitty/reload-kitty

# Using another link directive since I have multiple links to this directory and you can't have
# multiple keys with the same name in YAML
- link:
    ~/.local/bin/:
        glob: true
        path: git/subcommands/*

- create:
    - ~/code

- shell:
    -
        description: Rebuild bat cache if my custom theme isn't listed
        command: bat --list-themes | grep --quiet base16-brighter || bat cache --build
    -
        description: Link watchman configs
        command: fish ./watchman/install.fish
    -
        description: Install fish prompt for the root user
        command: fish ./fish/install_fish_prompt_for_root.fish
    -
        description: Install and start smart plug service
        command: ./smart-plug/install
    -
        description: Install and start languagetool service
        command: ./languagetool/install
    -
        description: Install .bashrc for the root user
        command: ./bash/install_bashrc_root
